---
title: "Modeling Greenhouse Gas Emissions Based on Sustainability Metrics^[Code and data supporting this analysis are available at: https://github.com/alyssaschleifer/ontario-energy-analysis]"
author: "Alyssa Schleifer"
date: "27 April 2022"
abstract: Data from recent years shows that Canada is falling behind other G20 nations in regards to improving its sustainable consumption and environmental performance in the face of a worsening global climate crisis. By analyzing data regarding energy and water usage of large buildings across Ontario, we can gain insight into several different metrics of environmental performance and determine their overall impact on greenhouse gas emissions. In order to achieve this, I used a multiple linear regression model to determine the relationship between variables such as water and electricity usage and overall greenhouse emissions to draw conclusions on the prevalence of these factors regarding their overall environmental impact. 
output:
  bookdown::pdf_document2:
    toc: false
    number_sections: false
  fig_caption: yes
---


## Introduction

In June of 2021, the Government of Canada adopted the Canadian Net Zero Emissions Accountability Act, which establishes their plan to achieve net-zero greenhouse gas emissions by 2050. Current scientific data suggests that in order to prevent the irreversible and disastrous effects of climate change, the global temperature change needs to be restricted to a 1.5 degrees Celsius increase compared to pre-industrial times.  However, as emissions continue to rise on a global scale, drastic steps must be taken in order to transition to total carbon neutrality. While working towards net-zero, analyzing how various sustainability metrics contribute to greenhouse gas emissions could help drive decision making. For instance, energy usage relies on burning fossil fuels for heating or electricity, thus contributing to the greenhouse effect. Intensive water usage is also strongly correlated to increased CO2 emissions. These existing metrics could be used to model greenhouse gas emissions even when concrete emission data is unavailable or impractical to collect. 

In the following paper, we will conduct an analysis of Ontario’s energy and greenhouse gas emissions based on public data sourced from large commercial and industrial buildings throughout the province.  A multiple linear regression model will be used to assess the relationship between several sustainability factors such as water, electricity, and natural gas usage, as well as other potentially influential variables such as region and building type (residential, school, wholesale/retailer, etc). From this analysis, we hypothesize that a higher usage of energy and water resources will show a strong, positive correlation with a building’s total greenhouse gas emissions. After running the model on the data, we will discuss the broader implications of the results in the context of their overall environmental impact and relevance to the issue at hand. 

This analysis will be carried out in `R` (R Core Team 2021), using the `dplyr` (Wickham et al. 2021), `knitr` (Xie 2021), `bookdown` (Xie 2021), and `tidyverse` (Wickham et al. 2019) packages. All figures and tables in this report are generated using `ggplot2` (Wickham 2016) and `kableExtra` (Zhu 2021).

## Data
```{r intro, include=FALSE, warning=FALSE}

library(tidyverse)
library(dplyr)
library(MASS)
library(ggplot2)
library(car)
library(glue)
library(DiagrammeR)
library(patchwork)
library(tableone)


rawdata <- read_csv("./inputs/raw_data.csv")

updated_data <- subset(rawdata, Ener_Star_Score!= "Not Available")
updated_data <- updated_data[-c(1, 3, 5:9, 11, 13, 15:21, 23:25, 27, 29:31)]
updated_data1 <- subset(updated_data, WN_Sit_Elc_Int2!= "Not Available", WN_Sit_Gas_Int2!= "Not Available")

updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Multifamily Housing")]<- "Housing"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Senior Living Community")]<- "Housing"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Residential Care Facility")]<- "Housing"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Supermarket/Grocery Store")]<- "Retail"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Retail Store")]<- "Retail"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Wholesale Club/Supercenter")]<- "Retail"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Financial Office")]<- "Office"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Medical Office")]<- "Office"
# updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "K-12 School")]<- "School"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "K-12 School")]<- "Mixed Use Property"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Non-Refrigerated Warehouse")]<- "Storage Facility"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Refrigerated Warehouse")]<- "Storage Facility"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Entrepôt réfrigéré")]<- "Storage Facility"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Entrepôt non réfrigéré")]<- "Storage Facility"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Self-Storage Facility")]<- "Storage Facility"
# updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Manufacturing/Industrial Plant")]<- "Factory"
updated_data1$PrimPropTypCalc[(updated_data1$PrimPropTypCalc == "Manufacturing/Industrial Plant")]<- "Mixed Use Property"


updated_data1$City[(updated_data1$City == "Ajax")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Aurora")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Brampton")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Etobicoke")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Markham")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Milton")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "MILTON")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Mississauga")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Mississisauga")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Newmarket")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "North York")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Oakville")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Oakville,")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Toronto")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Oshawa")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Richmond Hill")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Scarborough")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Thornhill")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Toronto/Markham n")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "TORONTO")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "Vaughan")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Whitby")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "Woodbridge")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "BRAMPTON")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "Bowmanville")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "Bolton")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "York")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "Burlington")]<- "Greater Toronto Area"	
updated_data1$City[(updated_data1$City == "Pickering")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Concord")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Don Mills")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "East Gwillimbury")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "East York")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Georgetown")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Torotno")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Halton Hills")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "North york")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "NORTH YORK")]<- "Greater Toronto Area"
updated_data1$City[(updated_data1$City == "Ancaster")]<- "Central Region"	
updated_data1$City[(updated_data1$City == "Hamilton")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Waterdown")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Stoney Creek")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Barrie")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Waterloo")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Brantford")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Orillia")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Simcoe")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Guelph")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Kitchener")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Cambridge")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Paris")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Peterborough")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Fergus")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Dundas")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Welland")]<- "Central Region"
updated_data1$City[(updated_data1$City == "St. Catharines")]<- "Central Region"
updated_data1$City[(updated_data1$City == "ST. CATHARINES")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Niagara Falls")]<- "Central Region"
updated_data1$City[(updated_data1$City == "Port Colborne")]<- "Central Region"
updated_data1$City[(updated_data1$City == "London")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "St. Thomas")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Windsor")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Stratford")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Chatham")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Woodstock")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "CORUNNA")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Sarnia")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Strathroy")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Grey Highlands")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Hanover")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Markdale")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Kincardine")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Owen Sound")]<- "Southwest Region"
updated_data1$City[(updated_data1$City == "Ottawa")]<- "Eastern Region"	
updated_data1$City[(updated_data1$City == "Nepean")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "Gloucester")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "Johnstown")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "Kanata")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "Kingston")]<- "Eastern Region"	
updated_data1$City[(updated_data1$City == "Belleville")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "Barrhaven")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "Arnprior")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "Carp")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "Orleans")]<- "Eastern Region"
updated_data1$City[(updated_data1$City == "North Bay")]<- "Northern Region"
updated_data1$City[(updated_data1$City == "Sault Ste Marie")]<- "Northern Region"
updated_data1$City[(updated_data1$City == "Sault Ste. Marie")]<- "Northern Region"
updated_data1$City[(updated_data1$City == "Sudbury")]<- "Northern Region"
updated_data1$City[(updated_data1$City == "Thunder Bay")]<- "Northern Region"
updated_data1$City[(updated_data1$City == "Timmins")]<- "Northern Region"

updatedata = rename(updated_data1, "Primary_Property_Type" = PrimPropTypCalc, "Region" = City, "Electricity_Intensity" = WN_Sit_Elc_Int2, "Natural_Gas_Intensity" = WN_Sit_Gas_Int2, "Water_Use_Intensity" = All_Water_Int1, "Energy_Use_Intensity" = WN_Site_EUI1, "GHG_Emissions_Intensity" = GHG_Emiss_Int1, "ENERGY_STAR_Score" = Ener_Star_Score)

data_new <- updatedata %>%                               # Replacing values
  mutate(Natural_Gas_Intensity = replace(Natural_Gas_Intensity, Natural_Gas_Intensity == "Not Available", NA))

data_new <- data_new %>%                               # Replacing values
  mutate(Water_Use_Intensity = replace(Water_Use_Intensity, Water_Use_Intensity == "Not Available", NA))

data_new <- data_new %>%                               # Replacing values
  mutate(Energy_Use_Intensity = replace(Energy_Use_Intensity, Energy_Use_Intensity == "Not Available", NA))

final_data<- data_new[complete.cases(data_new),]

final_data$Region<- as.factor(final_data$Region)
final_data$Primary_Property_Type<- as.factor(final_data$Primary_Property_Type)
final_data$Electricity_Intensity<- as.numeric(final_data$Electricity_Intensity)
final_data$Natural_Gas_Intensity <- as.numeric(final_data$Natural_Gas_Intensity)
final_data$Water_Use_Intensity<- as.numeric(final_data$Water_Use_Intensity)
final_data$Energy_Use_Intensity<- as.numeric(final_data$Energy_Use_Intensity)
final_data$GHG_Emissions_Intensity<- as.numeric(final_data$GHG_Emissions_Intensity)
final_data$ENERGY_STAR_Score<- as.numeric(final_data$ENERGY_STAR_Score)


# Checks
par(mfrow = c(2, 3))
boxplot(final_data$Electricity_Intensity)
boxplot(final_data$Natural_Gas_Intensity)
boxplot(final_data$Water_Use_Intensity)
boxplot(final_data$Energy_Use_Intensity)
boxplot(final_data$GHG_Emissions_Intensity)
boxplot(final_data$ENERGY_STAR_Score)


# Excluding influential observations that are skewing the results.  
final_data<- final_data[-which(final_data$Electricity_Intensity %in% max(final_data$Electricity_Intensity)),]
final_data<- final_data[-which(final_data$Natural_Gas_Intensity %in% max(final_data$Natural_Gas_Intensity)),]
final_data<- final_data[-which(final_data$Water_Use_Intensity %in% max(final_data$Water_Use_Intensity)),]
final_data<- final_data[-which(final_data$Energy_Use_Intensity %in% max(final_data$Energy_Use_Intensity)),]
final_data<- final_data[-which(final_data$GHG_Emissions_Intensity %in% max(final_data$GHG_Emissions_Intensity)),]
final_data<- final_data[-which(final_data$GHG_Emissions_Intensity %in% c(0)),]

# Checks
par(mfrow = c(2, 3))
boxplot(final_data$Electricity_Intensity)
boxplot(final_data$Natural_Gas_Intensity)
boxplot(final_data$Water_Use_Intensity)
boxplot(final_data$Energy_Use_Intensity)
boxplot(final_data$GHG_Emissions_Intensity)
boxplot(final_data$ENERGY_STAR_Score)


par(mfrow = c(2, 3))
plot(final_data$Electricity_Intensity, final_data$GHG_Emissions_Intensity)
plot(final_data$Natural_Gas_Intensity, final_data$GHG_Emissions_Intensity)
plot(final_data$Water_Use_Intensity, final_data$GHG_Emissions_Intensity)
plot(final_data$Energy_Use_Intensity, final_data$GHG_Emissions_Intensity)
plot(final_data$ENERGY_STAR_Score, final_data$GHG_Emissions_Intensity)

```

```{r, Data, echo=TRUE, fig.dim=c(7,6), fig.pos="!H"}


tableOne<- CreateTableOne(data=final_data)

kableone(tableOne)



```

```{r, echo = FALSE, r, fig.width=10,fig.height=13, fig.cap="Environmental Metrics by Ontario Region and Primary Property Type"}

# Creating plots for each variable 

# Bar plots for electricity intensity based on region and property type

a <- ggplot(data=final_data, aes(x=Region, y=Electricity_Intensity, fill=Region)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("goldenrod1", "darkorange1", "tomato", "red2", "firebrick")) + labs(x = "Ontario Region", y = "Electricity Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

b <- ggplot(data=final_data, aes(x=Primary_Property_Type, y=Electricity_Intensity, fill=Primary_Property_Type)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("lightcyan1", "lightskyblue1", "steelblue3", "skyblue4", "olivedrab3", "chartreuse4", "aquamarine4")) + labs(x = "Property Type", y = "Electricity Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

# Bar plots for natural gas intensity based on region and property type

c <- ggplot(data=final_data, aes(x=Region, y=Natural_Gas_Intensity, fill=Region)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("goldenrod1", "darkorange1", "tomato", "red2", "firebrick")) + labs(x = "Ontario Region", y = "Natural Gas Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

d <- ggplot(data=final_data, aes(x=Primary_Property_Type, y=Natural_Gas_Intensity, fill=Primary_Property_Type)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("lightcyan1", "lightskyblue1", "steelblue3", "skyblue4", "olivedrab3", "chartreuse4", "aquamarine4")) + labs(x = "Property Type", y = "Natural Gas Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

# Bar plots for water use intensity based on region and property type

e <- ggplot(data=final_data, aes(x=Region, y=Water_Use_Intensity, fill=Region)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("goldenrod1", "darkorange1", "tomato", "red2", "firebrick")) + labs(x = "Ontario Region", y = "Water Use Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

f <- ggplot(data=final_data, aes(x=Primary_Property_Type, y=Water_Use_Intensity, fill=Primary_Property_Type)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("lightcyan1", "lightskyblue1", "steelblue3", "skyblue4", "olivedrab3", "chartreuse4", "aquamarine4")) + labs(x = "Property Type", y = "Water Use Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

# Bar plots for energy use intensity based on region and property type

g <- ggplot(data=final_data, aes(x=Region, y=Energy_Use_Intensity, fill=Region)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("goldenrod1", "darkorange1", "tomato", "red2", "firebrick")) + labs(x = "Ontario Region", y = "Energy Use Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

h <- ggplot(data=final_data, aes(x=Primary_Property_Type, y=Energy_Use_Intensity, fill=Primary_Property_Type)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("lightcyan1", "lightskyblue1", "steelblue3", "skyblue4", "olivedrab3", "chartreuse4", "aquamarine4")) + labs(x = "Property Type", y = "Energy Use Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

# Bar plots for GHG emissions intensity based on region and property type

i <- ggplot(data=final_data, aes(x=Region, y=GHG_Emissions_Intensity, fill=Region)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("goldenrod1", "darkorange1", "tomato", "red2", "firebrick")) + labs(x = "Ontario Region", y = "GHG Emissions Intensity") + theme(legend.position="none", text = element_text(family = "Times"))

j <- ggplot(data=final_data, aes(x=Primary_Property_Type, y=GHG_Emissions_Intensity, fill=Primary_Property_Type)) +
  geom_bar(stat="summary", fun = "mean") + coord_flip() + theme_light() + scale_fill_manual(values=c("lightcyan1", "lightskyblue1", "steelblue3", "skyblue4", "olivedrab3", "chartreuse4", "aquamarine4")) + labs(x = "Property Type", y = "GHG Emissions Intensity") + theme(legend.position="none", text = element_text(family = "Times"))


# Plot and format all 10 bar plots 

theme_set(theme(text = element_text(family = "Times", size = 16)))
a + plot_spacer() + b + c + plot_spacer() + d + e + plot_spacer() + f + g + plot_spacer() + h + i + plot_spacer() + j + plot_layout(ncol = 3, widths = c(3, 0.2 , 3, 3, 0.2 , 3, 3, 0.2 , 3, 3, 0.2 , 3, 3, 0.2 , 3)) + plot_annotation(title = "Environmental Performance Metrics Fluctuate Based on Region and Property Type", subtitle = " ")

```

- Electricity Intensity, Natural Gas Intensity, and Energy Use Intensity are all weather-normalized values.

- Cities in Ontario are grouped into 5 regions: Central, Eastern, Northern, Southwestern, and Greater Toronto Area based on regional breakdown obtained from: https://www.constructionforecasts.ca/en/reference/definitions-ontario-regions



## Model


```{r, Model, echo=TRUE, fig.dim=c(7,6), fig.pos="!H"}

# Model 
natural<- lm(GHG_Emissions_Intensity ~ Region + Primary_Property_Type + Electricity_Intensity 
          + Natural_Gas_Intensity + Water_Use_Intensity + Energy_Use_Intensity, data=final_data)
summary(natural)

# QQ plot shows two influential observations
qqPlot(natural, id.method="identify",simulate=TRUE, main="Q-Q Plot")

op <- par(pty = "s", mfrow = c(1, 2))
qqnorm(natural$residuals)
qqline(natural$residuals)

# Checking the distribution of residuals, looks very skewed and non-normal.
hist(natural$residuals, breaks=60)

# Removing the two influential observations from further analysis.
inf_obs<- c(401, 435)
data_wo_inf_obs<- final_data[-inf_obs,]
hist(data_wo_inf_obs$GHG_Emissions_Intensity) # Looks skewed still
boxplot(data_wo_inf_obs$GHG_Emissions_Intensity)
natural_noinf<- lm(GHG_Emissions_Intensity ~ Region + Primary_Property_Type + Electricity_Intensity 
             + Natural_Gas_Intensity*Energy_Use_Intensity + Water_Use_Intensity, data=data_wo_inf_obs)
summary(natural_noinf)

op <- par(pty = "s", mfrow = c(1, 2))
qqnorm(natural_noinf$residuals)
qqline(natural_noinf$residuals) # Looks fairly normal but has some outliers around the tails.

hist(natural_noinf$residuals, breaks=60) # Looks fairly normal other than some outliers around the tails.

summary(step(natural_noinf))




```

## Results 

## Discussion 

## Appendix A
- Cities in Ontario are grouped into 5 regions: Central, Eastern, Northern, Southwestern, and Greater Toronto Area based on regional breakdown obtained from: https://www.constructionforecasts.ca/en/reference/definitions-ontario-regions



\newpage

## Bibliography

R Core Team. 2021. *R: A language and environment for statistical computing.* Vienna, Austria: R Foundation for Statistical Computing. https://www.R-project.org/.

Wickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain
François, Garrett Grolemund, et al. 2019. "Welcome to the tidyverse." *Journal of Open Source Software*, 4(43): 1686. https://doi.org/10.21105/joss.01686

Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2021. *Dplyr: A Grammar of Data Manipulation.* https://CRAN.R-project.org/package=dplyr.

Xie, Yihui. 2021. *bookdown: Authoring Books and Technical Documents with R Markdown.* https://CRAN.R-project.org/package=bookdown

Xie, Yihui. 2021. *knitr: A General-Purpose Package for Dynamic Report Generation in R.* https://CRAN.R-project.org/package=knitr

Zhu, Hao. 2021. *kableExtra: Construct Complex Table with 'kable' and Pipe Syntax* https://CRAN.R-project.org/package=kableExtra
